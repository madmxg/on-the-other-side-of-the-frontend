<!doctype html>
<html lang="en">
  <head>
    <title>On the other side of the frontend</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="node_modules/@shower/ribbon/styles/styles.css" />
    <style>
      .shower {
        --slide-ratio: calc(16 / 9);
      }
      .slide pre {
        font-size: 18px;
      }
      .slide pre code.add {
        background-color: rgba(0, 128, 0, 0.1);
        color: green;
      }
      .slide pre code.del {
        background-color: rgba(255, 0, 0, 0.1);
        color: red;
      }
    </style>
  </head>
  <body class="shower list">
    <header class="caption">
      <h1>–ü–æ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞</h1>
      <p><a target="_blank" href="https://t.me/madmxg">Mikhail Garbuzov</a>, Jetty Cloud.</p>
    </header>

    <section class="slide">
      <h2 class="shout" style="font-size: 3em">–ü–æ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞</h2>
    </section>

    <section class="slide">
      <p>Intro</p>
      <h3 style="font-size: 2em; margin-block-end: 0px">–ú–∏—Ö–∞–∏–ª –ì–∞—Ä–±—É–∑–æ–≤</h3>
      <ol>
        <li>Software Engineer at JettyCloud</li>
        <li>
          MoscowJS Co-Organizer
          <code class="comment" style="color: rgba(128, 128, 128, 0.4); background-color: initial">
            Q9S-X29
          </code>
        </li>
        <li>More than 10 Y expirience with JS dev</li>
      </ol>
    </section>

    <section class="slide">
      <h2 class="shout">–ú–æ—Ç–∏–≤–∞—Ü–∏—è</h2>
    </section>

    <section class="slide">
      <h2 class="shout grow">üôã‚Äç‚ôÄÔ∏è&nbsp;üôã‚Äç‚ôÇÔ∏è</h2>
      <!-- TODO: –∑–∞–ª –∏–∑ —ç–º–æ–¥–∂–∏ —Å–ª—É—à–∞—Ç–µ–ª–µ–π -->
      <!-- <h2 class="shout grow">üôã‚Äç‚ôÄÔ∏è&nbsp;üôã‚Äç‚ôÇÔ∏è</h2> -->
      <!-- <h2 class="shout grow">üôã‚Äç‚ôÄÔ∏è&nbsp;üôã‚Äç‚ôÇÔ∏è</h2> -->
    </section>

    <section class="slide">
      <h2>–ö–∞–∫ –æ–±—ã—á–Ω–æ –≤—ã –≤–∏–¥–∏—Ç–µ –±–µ–∫—ç–Ω–¥</h2>
    </section>

    <section class="slide">
      <h2>–ö–∞–∫ –æ–±—ã—á–Ω–æ –≤—ã –≤–∏–¥–∏—Ç–µ –±–µ–∫—ç–Ω–¥</h2>
      <ol>
        <li>GraphQL</li>
      </ol>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/graphql.jpg" />
    </section>

    <section class="slide">
      <h2>–ö–∞–∫ –æ–±—ã—á–Ω–æ –≤—ã –≤–∏–¥–∏—Ç–µ –±–µ–∫—ç–Ω–¥</h2>
      <ol>
        <li>GraphQL</li>
        <li>OpenAPI / Swagger</li>
      </ol>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/swagger.jpg" />
    </section>

    <section class="slide">
      <h2>–ö–∞–∫ –æ–±—ã—á–Ω–æ –≤—ã –≤–∏–¥–∏—Ç–µ –±–µ–∫—ç–Ω–¥</h2>
      <ol>
        <li>GraphQL</li>
        <li>OpenAPI / Swagger</li>
        <li>SOAP</li>
      </ol>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/soap.jpg" />
    </section>

    <section class="slide">
      <h2>–ö–∞–∫ –æ–±—ã—á–Ω–æ –≤—ã –≤–∏–¥–∏—Ç–µ –±–µ–∫—ç–Ω–¥</h2>
      <ol>
        <li>GraphQL</li>
        <li>OpenAPI / Swagger</li>
        <li>SOAP</li>
        <li>...</li>
      </ol>
    </section>

    <section class="slide">
      <p style="color: brown">500</p>
      <p class="note">Internal Server Error</p>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/mermaid.jpeg" />
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/mermaid-fb.jpg" />
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">–Ø –∏ —Ç–∞–∫ —É–º–µ—é –ø–∏—Å–∞—Ç—å backend</h2>
    </section>

    <section class="slide">
      <pre class="place">
        <code>const express = require('express')</code>
        <code>const app = express()</code>
        <code>const port = 3000</code>
        <code>app.get('/', (req, res) => {</code>
        <code>  res.send('Hello World!')</code>
        <code>})</code>
        <code>app.listen(port, () => {</code>
        <code>  console.log(`Example app listening on port ${port}`)</code>
        <code>})</code>
      </pre>
    </section>

    <section class="slide">
      <pre class="place">
        <code>'use server'</code>
        <code>    </code>
        <code>export async function greeting(subject: string) {</code>
        <code>  try {</code>
        <code>    return `Hello ${subject}`</code>
        <code>  } catch (error) {</code>
        <code>    throw new Error('Failed to greeting')</code>
        <code>  }</code>
        <code>}</code>
      </pre>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/next-use-server.jpeg" />
    </section>

    <section class="slide">
      <h2>BE - —ç—Ç–æ —Å–∫—É—á–Ω–æ</h2>
      <ol>
        <li class="next">–ø–µ—Ä–µ–∫–ª–∞–¥—ã–≤–∞–µ–º JSON`—ã</li>
        <li class="next">–∫–æ–ø–∏–ø–∞—Å—Ç–∏–ø 100500 CRUD</li>
        <li class="next">... ?</li>
        <li class="next">PROFIT</li>
      </ol>
    </section>

    <section class="slide">
      <h2>FE - —ç—Ç–æ —Å–∫—É—á–Ω–æ</h2>
      <ol>
        <li class="next">—à–ª–µ–ø–∞–µ–º —Ñ–æ—Ä–º—ã</li>
        <li class="next">–∫—Ä–∞—Å–∏–º/–¥–≤–∏–≥–∞–µ–º –∫–Ω–æ–ø–∫–∏</li>
        <li class="next">–≤—ã–±–∏—Ä–∞–µ–º —Å—Ç–µ–π—Ç –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</li>
        <li class="next">—Å—Ç—Ä–∞–¥–∞–µ–º –ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ —Ä–µ–¥—å—é—Å–µ—Ä–æ–≤ –¥–ª—è Redux</li>
      </ol>
    </section>

    <section class="slide">
      <h2>{{ Placeholder }} - —ç—Ç–æ —Å–∫—É—á–Ω–æ</h2>
      <ol>
        <li>[QA] –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—é—Ç</li>
        <li>[DevOps] yaml developer</li>
      </ol>
    </section>

    <section class="slide">
      <h2 class="shout">Iceberg</h2>
    </section>

    <section
      class="slide clear"
      style="
        background-color: #0b71b1;
        background: linear-gradient(
          0deg,
          rgba(2, 0, 36, 1) 0%,
          rgba(9, 9, 121, 1) 35%,
          rgba(0, 212, 255, 1) 100%
        );
      "
    >
      <img class="cover h" src="assets/images/iceberg.jpeg" />
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">OK, —Å —á–µ–≥–æ –Ω–∞—á–∞—Ç—å?</h2>
    </section>

    <section class="slide">
      <h2>Requirements</h2>
      <ol>
        <li class="next">Javascript</li>
      </ol>
    </section>

    <section class="slide">
      <h2>Requirements</h2>
      <ol>
        <li>
          <del>Javascript</del>
          Typescript
        </li>
        <li class="next">Jest</li>
        <li class="next">Express</li>
        <li class="next">npm</li>
      </ol>
    </section>

    <section
      class="slide clear"
      style="
        background: rgb(172, 35, 51);
        background: radial-gradient(circle, rgba(172, 35, 51, 1) 0%, rgba(40, 2, 5, 1) 100%);
      "
    >
      <img class="cover h" src="assets/images/thats-all-folks.svg" />
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">–°—Ç–∞—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞</h2>
    </section>

    <section class="slide">
      <pre class="place">
        <code>npm init --yes</code>
        <code>npm install express {lodash,ramda,fp-ts}</code>
      </pre>
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">Dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</h2>
    </section>

    <section class="slide">
      <pre class="place">
        <code>npm install -D \</code>
        <code>  eslint prettier husky lint-staged \</code>
        <code>  jest \</code>
        <code>  </code>
        <code>  typescript \</code>
        <code>  @types/node \</code>
        <code>  @tsconfig/node20 \</code>
        <code>  @tsconfig/strictest \</code>
      </pre>
    </section>

    <section class="slide">
      <h2>–ò–∑—É—á–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é</h2>
      <p>https://nodejs.org/docs</p>
      <p>https://expressjs.com</p>
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">–ü–∏—à–µ–º –Ω–∞—à–µ –±–µ–∫–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h2>
    </section>

    <section class="slide">
      <pre class="place">
        <code>import express from 'express';</code>
        <code>import { config } from './config';</code>
        <code>import { routes } from './routes';</code>
        <code>  </code>
        <code>const app = express();</code>
        <code>app.use(routes());</code>
        <code>  </code>
        <code>app.get('/', (req, res) => res.send('Hello, World!'));</code>
        <code>app.listen(config.server.port, () => {</code>
        <code>  console.log(`Server is running on port ${config.server.port}`);</code>
        <code>});</code>
      </pre>
    </section>

    <section class="slide">
      <h2>–ü–∏—à–µ–º –∫–∞–∫—É—é-—Ç–æ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫—É</h2>
      <p>–ö–æ—Ç–æ—Ä–∞—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –≤–∞—à—É –∑–∞–¥–∞—á—É</p>
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è</h2>
    </section>

    <section class="slide">
      <h2>–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è (–∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è)</h2>
      <ul>
        <li>Docker</li>
        <li>Podman</li>
        <li></li>
        <li>k8s</li>
      </ul>
    </section>

    <section class="slide">
      <pre class="place">
        <code>  FROM node as builder</code>
        <code>  WORKDIR /opt/app</code>
        <code>  RUN npm ci && npm run build</code>
        <code>  FROM nginx as runner</code>
        <code>  COPY --from=builder /opt/app /opt/app</code>
        <code>  EXPOSE 80</code>
        <code>  CMD ["/usr/sbin/nginx", "-g", "daemon off;"]</code>
      </pre>
    </section>

    <section class="slide">
      <pre class="place">
        <code>  FROM node as builder</code>
        <code>  WORKDIR /opt/app</code>
        <code>  RUN npm ci && npm run build</code>
        <code class="del">- FROM nginx as runner</code>
        <code class="add">+ FROM builder as runner</code>
        <code>  COPY --from=builder /opt/app /opt/app</code>
        <code>  EXPOSE 80</code>
        <code>  CMD ["/usr/sbin/nginx", "-g", "daemon off;"]</code>
      </pre>
    </section>

    <section class="slide">
      <pre class="place">
        <code>  FROM node as builder</code>
        <code>  WORKDIR /opt/app</code>
        <code>  RUN npm ci && npm run build</code>
        <code class="del">- FROM nginx as runner</code>
        <code class="add">+ FROM builder as runner</code>
        <code>  COPY --from=builder /opt/app /opt/app</code>
        <code class="del">- EXPOSE 80</code>
        <code class="add">+ EXPOSE 3000</code>
        <code>  CMD ["/usr/sbin/nginx", "-g", "daemon off;"]</code>
      </pre>
    </section>

    <section class="slide">
      <pre class="place">
        <code>  FROM node as builder</code>
        <code>  WORKDIR /opt/app</code>
        <code>  RUN npm ci && npm run build</code>
        <code class="del">- FROM nginx as runner</code>
        <code class="add">+ FROM builder as runner</code>
        <code>  COPY --from=builder /opt/app /opt/app</code>
        <code class="del">- EXPOSE 80</code>
        <code class="add">+ EXPOSE 3000</code>
        <code class="del">- CMD ["/usr/sbin/nginx", "-g", "daemon off;"]</code>
        <code class="add">+ CMD ["node", "dist/index.js"]</code>
      </pre>
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">Production?</h2>
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">Probes</h2>
    </section>

    <section class="slide">
      <p>Liveness / Readiness / Startup</p>
      <p>
        Docker
        <br />
        <span>
          <a
            target="_blank"
            href="https://docs.docker.com/compose/compose-file/05-services/#healthcheck"
            >https://docs.docker.com/compose/compose-file/05-services/#healthcheck</a
          >
        </span>
      </p>

      <p>
        k8s
        <br />
        <a
          target="_blank"
          href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/"
          >https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/</a
        >
      </p>
    </section>

    <section class="slide">
      <pre class="place">
        <code>import express from 'express';</code>
        <code>  </code>
        <code>function probes(): Router {</code>
        <code>  const router = Router();</code>
        <code>  </code>
        <code>  router.get('/healthz', (_req, res): void => {</code>
        <code>    res.status(200).json({ msg: 'ok' });</code>
        <code>  });</code>
        <code>  </code>
        <code>  router.get('/readiness', (_req, res): void => {</code>
        <code>    res.status(200).json({ msg: 'ok' });</code>
        <code>  });</code>
        <code>  return router;</code>
        <code>}</code>
      </pre>
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">Logs</h2>
    </section>

    <section class="slide">
      <ul class="place">
        <li>ELK</li>
        <li>Splunk</li>
        <li>Datadog</li>
      </ul>
    </section>

    <section class="slide">
      <pre class="place">
        <code>npm install winston</code>
      </pre>
    </section>

    <section class="slide">
      <pre class="place">
        <code>import winston from 'winston';</code>
        <code>import { config } from './config';</code>
        <code>  </code>
        <code>const { levels, colors } = winston.config.npm;</code>
        <code>winston.addColors(colors);</code>
        <code>  </code>
        <code>export const logger = winston.createLogger({</code>
        <code>  levels,</code>
        <code>  level: config.server.logLevel,</code>
        <code>  format: winston.format.combine(winston.format.timestamp(), winston.format.json()),</code>
        <code>  defaultMeta: { service: 'app-backend' },</code>
        <code>  transports: [new winston.transports.Console()],</code>
        <code>});</code>
      </pre>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/kibana.jpg" />
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">Metrics</h2>
    </section>

    <section class="slide">
      <ul class="place">
        <li>Prometheus</li>
        <li>VictoriaMetrics</li>
        <li>Grafana</li>
      </ul>
    </section>

    <section class="slide">
      <pre class="place">
        <code>npm install express-prom-bundle prom-client</code>
      </pre>
    </section>

    <section class="slide">
      <pre class="place">
        <code>import winston from 'winston';</code>
        <code>import promBundle from 'express-prom-bundle';</code>
        <code>import { collectDefaultMetrics } from 'prom-client';</code>
        <code>  </code>
        <code>...</code>
        <code>  </code>
        <code>const metricsMiddleware = promBundle({ includeMethod: true });</code>
        <code>collectDefaultMetrics();</code>
        <code>  </code>
        <code>app.use(metricsMiddleware);</code>
        <code>  </code>
        <code>...</code>
      </pre>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/grafana.png" />
    </section>

    <section class="slide">
      <pre class="place">
        <code>import { Gauge } from 'prom-client';</code>
        <code>  </code>
        <code>const statusGauge = new Gauge({ name: 'tjs_app_hits_counter' });</code>
        <code>  </code>
        <code>function counter(): Router {</code>
        <code>  const router = Router();</code>
        <code>  router.get('/increment', (_req, res): void => {</code>
        <code>    statusGauge.inc();</code>
        <code>    res.status(200).send();</code>
        <code>  });</code>
        <code>  router.get('/decrement', (_req, res): void => {</code>
        <code>    statusGauge.dec();</code>
        <code>    res.status(200).send();</code>
        <code>  });</code>
        <code>  return router;</code>
        <code>}</code>
      </pre>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/v-metrics-gauge.jpg" />
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">Traces</h2>
    </section>

    <section class="slide">
      <ul class="place">
        <li>Dynatrace</li>
        <li>Jaeger</li>
        <li>Zipkin</li>
        <li>OpenTelemetry</li>
      </ul>
    </section>

    <section class="slide">
      <pre class="place">
        <code>npm install @opentelemetry/api @opentelemetry/sdk-node \</code>
        <code>  @opentelemetry/auto-instrumentations-node \</code>
        <code>  @opentelemetry/exporter-trace-otlp-grpc \</code>
        <code>  @opentelemetry/sdk-trace-node \</code>
        <code>  @opentelemetry/sdk-metrics</code>
      </pre>
    </section>

    <section class="slide">
      <pre class="place">
        <code>import { NodeSDK } from '@opentelemetry/sdk-node';</code>
        <code>...</code>
        <code>// WIP</code>
      </pre>
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/jaeger-search.jpg" />
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/jaeger-search-id.jpg" />
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/jaeger-dag.jpg" />
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/jaeger-fdg.jpg" />
    </section>

    <section class="slide clear">
      <img class="cover h" src="assets/images/jaeger-monitor.jpg" />
    </section>

    <section class="slide">
      <h2>Alerting</h2>
      <ul>
        <li>Opsgenie</li>
        <li>PagerDuty</li>
        <li>Grafana OnCall</li>
      </ul>
    </section>

    <section class="slide">
      <h2>Framework</h2>
      <ul>
        <li>ExpressJS</li>
        <li>Koa</li>
        <li>NestJS</li>
        <li>NextJS</li>
        <li>TODO: –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Å–æ —Å—Ç–µ–π—Ç –æ—Ñ –ñ–°</li>
      </ul>
    </section>

    <section class="slide">
      <h2 class="shout" style="font-size: 2em">–†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏</h2>
      <p>ORM</p>
      <p>ODM</p>
      <p>...</p>
    </section>

    <section class="slide">
      <h2>Migration</h2>
      <ul>
        <li>Opt in ORM</li>
        <li>Plain SQL</li>
        <li>JS scripts for MongoDB</li>
        <li>scripts</li>
      </ul>
    </section>

    <section class="slide">
      <h2>Versioning</h2>
    </section>

    <section
      class="slide clear"
      style="
        background: rgb(172, 35, 51);
        background: radial-gradient(circle, rgba(172, 35, 51, 1) 0%, rgba(40, 2, 5, 1) 100%);
      "
    >
      <img class="cover h" src="assets/images/thats-all-folks.svg" />
    </section>

    <section class="slide">
      <h2>QA</h2>
    </section>

    <footer class="badge">
      <a href="https://github.com/shower/shower">Fork me on GitHub</a>
    </footer>

    <div class="progress"></div>

    <script src="node_modules/@shower/core/dist/shower.js"></script>
  </body>
</html>
